{"id":2363,"date":"2018-12-14T16:35:28","date_gmt":"2018-12-15T00:35:28","guid":{"rendered":"http:\/\/davidegerosa.com\/?page_id=2363"},"modified":"2022-01-21T18:02:30","modified_gmt":"2022-01-21T18:02:30","slug":"nsphere","status":"publish","type":"page","link":"https:\/\/davidegerosa.com\/nsphere\/","title":{"rendered":"Balls in many dimensions"},"content":{"rendered":"\n<p>I recently came across a very funny math thing, which has to do with the volume of spheres in N dimensions. Sure, not really meaningful from a physical point of view, but still very funny to think about it.<\/p>\n\n\n\n<p>I led a discussion on this during one of the 2018 <a rel=\"noreferrer noopener\" href=\"http:\/\/www.tapir.caltech.edu\/\" target=\"_blank\">TAPIR<\/a> Postdoc lunches at Caltech. Thanks to everybody that was there!<\/p>\n\n\n\n<p>Here is the thing: <strong>The volume of an N-dimensional sphere goes to zero (!) as the number of dimensions increases. In other terms, balls are empty in very high dimensional spaces.<\/strong> That&#8217;s sooo weird.<\/p>\n\n\n\n<p>To be more precise, one should really say that the ratio between the volume of a sphere and that of a cube goes to zero. Imagine putting a circle inside a square in 2D: the area of the square is \\(4r^2\\), while the area of the circle is \\(\\pi r^2\\). What&#8217;s left (&#8220;the corners&#8221;) have area \\((4-\\pi) r^2\\). In 2D, there&#8217;s more area in the circle than in the corners. It turns out that if you crank up the number of dimensions, <em>all<\/em> of the volume is contained in the corners!<\/p>\n\n\n\n<p>Of course, I couldn&#8217;t believe this and had to convince myself with both maths and &#8220;experiments&#8221;.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Maths&#8230;<\/h2>\n\n\n\n<p>So, let&#8217;s calculate the volume of a sphere in N dimensions. There are many ways to carry out this proof; this is a simple one taken from <a href=\"https:\/\/en.wikipedia.org\/wiki\/Volume_of_an_n-ball\" target=\"_blank\" rel=\"noopener noreferrer\">the source of all knowledge<\/a>. We expect the volume to scale with the radius as \\(V_N(r)\\propto r^N\\). We want to find the constant of proportionality as a function of N.<\/p>\n\n\n\n<p>We deal with numbers \\(\\boldsymbol{x}=\\{{x_1, x_2,&#8230;, x_n}\\}\\in \\mathbb{R}^n\\), which are really arrays of reals. We need a function and, for simplicity, let&#8217;s just take a Gaussian<\/p>\n\n\n\n\\(f(\\boldsymbol{x}) = \\exp\\left( &#8211; \\frac{1}{2} \\sum_{i=1}^N x_i^2 \\right) = \\prod_{i=1}^N \\exp\\left( &#8211; \\frac{1}{2} x_i^2 \\right)\\)\n\n\n\n<p>The idea is to integrate this function in two different sets of coordinates and compare the result. First, let&#8217;s integrate in cartesian coordinates:<\/p>\n\n\n\n\\(\\int_{\\mathbb{R}^n} f(\\boldsymbol{x}) d \\boldsymbol{x} = \\int_{-\\infty}^{+\\infty}&#8230;\\int_{-\\infty}^{+\\infty} f(\\boldsymbol{x}) dx_1&#8230; dx_N = \\prod_{i=1}^N \\int_{-\\infty}^{+\\infty}\\exp\\left( &#8211; \\frac{1}{2} x_i^2 \\right) dx_i = (2\\pi)^{N\/2}\\)\n\n\n\n<p>Each of those piece is a single-dimensional gaussian, and we know that a gaussians integrate to \\(\\sqrt{2\\pi}\\). We have N of them, so that gives you \\((2\\pi)^{N\/2}\\).<\/p>\n\n\n\n<p>Now, let&#8217;s do the same thing in spherical coordinate. The distance from the origin is \\(r^2=\\sum_i x_i^2\\). We divide \\({\\mathbb{R}^n}\\) into shells of dimension N-1 and then integrate radially, i.e.<br>\n\\(\\int_{\\mathbb{R}^n} f(\\boldsymbol{x}) d \\boldsymbol{x} = \\int_0^\\infty \\int_{S_{N-1}(r)} \\exp\\left(-\\frac{1}{2} r^2\\right) dA dr = \\int_0^\\infty \\exp\\left(-\\frac{1}{2} r^2\\right) \\left[\\int_{S_{N-1}(r)} dA\\right] dr\\)\n\n\n\n<p>The term in brakets is the surface of a N-1 dimensional sphere, which is expected to scale as \\(r^{N-1}\\), i.e.<\/p>\n\n\n\n\\(\\int_{S_{N-1}(r)} dA = A_{N-1}(r) = A_{N-1}(1) r^{N-1}\\)\n\n\n\n<p>So, the integral above becomes (substitute \\(t=r^2\/2\\))<\/p>\n\n\n\n\\(&#8230; = A_{N-1}(1) \\int_0^\\infty r^{N-1} \\exp\\left(-\\frac{1}{2} r^2\\right) = A_{N-1}(1) 2^{(n-2)\/2}\\int_0^\\infty e^{-t} t^{(n-2)\/2} dt = A_{N-1}(1) 2^{(n-2)\/2} \\Gamma\\left(\\frac{n}{2}\\right)\\)\n\n\n\n<p>The last thing is a<a href=\"https:\/\/en.wikipedia.org\/wiki\/Gamma_function\" target=\"_blank\" rel=\"noopener noreferrer\"> Gamma function<\/a>, which is <em>defined<\/em> by the integral above, so not much to say there. It basically the generalization of factorials to non-integer numbers.<\/p>\n\n\n\n<p>Now we can equate the integrals \\(\\int_{\\mathbb{R}^n} f(\\boldsymbol{x}) d \\boldsymbol{x}\\) computed with both sets of coordinates to obtain<\/p>\n\n\n\n\\(A_{N-1}(1) = \\frac{2 \\pi^{n\/2}}{\\Gamma\\left(\\frac{n}{2}\\right)}\\)\n\n\n\n<p>We thus have the surface area of the (N-1)dimensional sphere<\/p>\n\n\n\n\\(A_{N-1}(r) = \\frac{2 \\pi^{n\/2}}{\\Gamma\\left(\\frac{n}{2}\\right) } r^{N-1}\\)\n\n\n\n<p>The N-volume is now obtained by integrating the surface \\(A_{N-1}(r)\\) along \\(r\\) (easy! it&#8217;s a polinomial!)<\/p>\n\n\n\n\\(V_N(r) = \\int_0^\\infty A_{N-1}(r) dr = \\frac{2 \\pi^{n\/2}}{n \\Gamma\\left(\\frac{n}{2}\\right)}r^N = \\frac{\\pi^{n\/2}}{\\Gamma\\left(\\frac{n}{2}+1\\right)}r^N\\)\n\n\n\n<p>where at the end we used the Gamma function property \\(z\\Gamma(z) = \\Gamma(z+1)\\).<\/p>\n\n\n\n<p>So, this is the final result:<\/p>\n\n\n\n\\(V_N(r) = \\frac{\\pi^{n\/2}}{\\Gamma\\left(\\frac{n}{2}+1\\right)}r^N\\)\n\n\n\n<p>The N-dimensional volume scale as the inverse of a Gamma function. So, it goes to zero, and it goes to zero really fast! Faster than an exponential, actually. This is because \\(\\Gamma(z+1)\\sim \\sqrt{2 \\pi z}(z\/e)^z\\) as \\(z\\to\\infty\\) (this thing is called <a href=\"https:\/\/en.wikipedia.org\/wiki\/Stirling%27s_approximation\" target=\"_blank\" rel=\"noopener noreferrer\">Stirling formula<\/a>).<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Code&#8230;<\/h2>\n\n\n\n<p>That&#8217;s hard to believe, so I had to do an experiment, which for me really means putting this thing into a computer. <a rel=\"noopener noreferrer\" href=\"https:\/\/gist.github.com\/dgerosa\/06e521cc1d5bc4c584cb9d5327d64963\" target=\"_blank\">Here is the simple python code<\/a> I wrote to compute the N-dimensional volume.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<div class=\"wp-block-coblocks-gist\"><script src=\"https:\/\/gist.github.com\/dgerosa\/06e521cc1d5bc4c584cb9d5327d64963.js\"><\/script><noscript><a href=\"https:\/\/gist.github.com\/dgerosa\/06e521cc1d5bc4c584cb9d5327d64963\">View this gist on GitHub<\/a><\/noscript><\/div>\n\n\n\n<p><\/p>\n\n\n\n<p>It&#8217;s a Monte-Carlo strategy, and it&#8217;s actually very simple. We throw a large number of random points in the N-dimensional cube and select those that are inside the sphere. The volume of the sphere is the volume of the cube times the fraction of accepted points<\/p>\n\n\n\n\\(V_{\\rm N sphere} = V_{\\rm N cube} \\frac{N_{\\rm accepted}}{N_{\\rm total}}\\).<\/p>\n\n\n\n<p>We do this for many dimensions D up to 30 and check the volumes we find against the exact solution we proved above. If you run that code, this is what you get:<\/p>\n\n\n\n<pre class=\"wp-block-syntaxhighlighter-code\">D=2 N=10000000 N_in=7854391 V=3.14176 Sol=3.14159 diff=0.00005 t=0.63s\nD=3 N=10000000 N_in=5236198 V=4.18896 Sol=4.18879 diff=0.00004 t=0.92s\nD=4 N=10000000 N_in=3084039 V=4.93446 Sol=4.93480 diff=0.00007 t=1.16s\nD=5 N=10000000 N_in=1645407 V=5.26530 Sol=5.26379 diff=0.00029 t=1.35s\nD=6 N=10000000 N_in=808056 V=5.17156 Sol=5.16771 diff=0.00074 t=1.74s\nD=7 N=10000000 N_in=370005 V=4.73606 Sol=4.72477 diff=0.00239 t=1.89s\nD=8 N=10000000 N_in=158915 V=4.06822 Sol=4.05871 diff=0.00234 t=2.08s\nD=9 N=10000000 N_in=064144 V=3.28417 Sol=3.29851 diff=0.00435 t=2.50s\nD=10 N=10000000 N_in=025101 V=2.57034 Sol=2.55016 diff=0.00791 t=3.78s\nD=11 N=10000000 N_in=009097 V=1.86307 Sol=1.88410 diff=0.01117 t=3.54s\nD=12 N=10000000 N_in=003223 V=1.32014 Sol=1.33526 diff=0.01133 t=3.11s\nD=13 N=10000000 N_in=001055 V=0.86426 Sol=0.91063 diff=0.05092 t=3.27s\nD=14 N=10000000 N_in=000382 V=0.62587 Sol=0.59926 diff=0.04439 t=3.41s\nD=15 N=10000000 N_in=000114 V=0.37356 Sol=0.38144 diff=0.02068 t=3.62s\nD=16 N=10000000 N_in=000026 V=0.17039 Sol=0.23533 diff=0.27594 t=3.65s\nD=17 N=10000000 N_in=000012 V=0.15729 Sol=0.14098 diff=0.11566 t=3.80s\nD=18 N=10000000 N_in=000002 V=0.05243 Sol=0.08215 diff=0.36176 t=4.06s\nD=19 N=10000000 N_in=000001 V=0.05243 Sol=0.04662 diff=0.12456 t=4.54s\nD=20 N=10000000 N_in=000001 V=0.10486 Sol=0.02581 diff=3.06316 t=4.47s\nD=21 N=10000000 N_in=000000 V=0.00000 Sol=0.01395 diff=1.00000 t=5.10s\nD=22 N=10000000 N_in=000000 V=0.00000 Sol=0.00737 diff=1.00000 t=5.42s\nD=23 N=10000000 N_in=000000 V=0.00000 Sol=0.00381 diff=1.00000 t=5.27s\nD=24 N=10000000 N_in=000000 V=0.00000 Sol=0.00193 diff=1.00000 t=5.68s\nD=25 N=10000000 N_in=000000 V=0.00000 Sol=0.00096 diff=1.00000 t=6.46s\nD=26 N=10000000 N_in=000000 V=0.00000 Sol=0.00047 diff=1.00000 t=6.16s\nD=27 N=10000000 N_in=000000 V=0.00000 Sol=0.00022 diff=1.00000 t=6.51s\nD=28 N=10000000 N_in=000000 V=0.00000 Sol=0.00010 diff=1.00000 t=6.99s\nD=29 N=10000000 N_in=000000 V=0.00000 Sol=0.00005 diff=1.00000 t=6.91s\nD=30 N=10000000 N_in=000000 V=0.00000 Sol=0.00002 diff=1.00000 t=7.29s\n<\/pre>\n\n\n\n<p>For D=2 we get 3.14&#8230; which is \\(\\pi\\). The volume then goes up till D=5. That&#8217;s the number of dimensions in which a sphere is &#8220;maximally filling&#8221;. After that, it decreases like crazy. This code is really good up only up to D=15 or so. After that, the sphere is so small that the number of points \\(N_{\\rm accepted}\\) is basically zero and the error made on the predictions is close to 100%. This is the same information in a plot. The two solutions seem to agree on that scale, but if you look at the errors (bottom plot), that becomes huge.<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-large\"><img decoding=\"async\" loading=\"lazy\" width=\"449\" height=\"793\" src=\"http:\/\/davidegerosa.com\/wp-content\/uploads\/2018\/12\/nsphere.png\" alt=\"\" class=\"wp-image-2364\" srcset=\"https:\/\/davidegerosa.com\/wp-content\/uploads\/2018\/12\/nsphere.png 449w, https:\/\/davidegerosa.com\/wp-content\/uploads\/2018\/12\/nsphere-170x300.png 170w\" sizes=\"(max-width: 449px) 100vw, 449px\" \/><\/figure><\/div>\n\n\n\n<p>BTW, I still think it&#8217;s weird. What happens if you pour water in an N-dimensional spherical ball? Can&#8217;t fit any water in it. Wait. What&#8217;s N-dimensional water?<\/p>\n","protected":false},"excerpt":{"rendered":"<p>I recently came across a very funny math thing, which has to do with the volume of spheres in N dimensions. Sure, not really meaningful from a physical point of view, but still very funny to think about it. I &hellip; <a href=\"https:\/\/davidegerosa.com\/nsphere\/\">Continue reading <span class=\"meta-nav\">&rarr;<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":698,"parent":0,"menu_order":0,"comment_status":"closed","ping_status":"closed","template":"","meta":{"_coblocks_attr":"","_coblocks_dimensions":"","_coblocks_responsive_height":"","_coblocks_accordion_ie_support":"","_mi_skip_tracking":false,"_monsterinsights_sitenote_active":false,"_monsterinsights_sitenote_note":"","_monsterinsights_sitenote_category":0,"footnotes":""},"jetpack_sharing_enabled":true,"_links":{"self":[{"href":"https:\/\/davidegerosa.com\/wp-json\/wp\/v2\/pages\/2363"}],"collection":[{"href":"https:\/\/davidegerosa.com\/wp-json\/wp\/v2\/pages"}],"about":[{"href":"https:\/\/davidegerosa.com\/wp-json\/wp\/v2\/types\/page"}],"author":[{"embeddable":true,"href":"https:\/\/davidegerosa.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/davidegerosa.com\/wp-json\/wp\/v2\/comments?post=2363"}],"version-history":[{"count":9,"href":"https:\/\/davidegerosa.com\/wp-json\/wp\/v2\/pages\/2363\/revisions"}],"predecessor-version":[{"id":4729,"href":"https:\/\/davidegerosa.com\/wp-json\/wp\/v2\/pages\/2363\/revisions\/4729"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/davidegerosa.com\/wp-json\/wp\/v2\/media\/698"}],"wp:attachment":[{"href":"https:\/\/davidegerosa.com\/wp-json\/wp\/v2\/media?parent=2363"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}